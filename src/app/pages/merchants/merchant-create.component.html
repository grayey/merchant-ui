<fury-page>
    <fury-title class="title">
      <mat-icon [@scaleIn]>description</mat-icon>
      <span [@fadeInRight]>Create Merchant</span>
    </fury-title>
  
    <div fxLayout="column"  class="mt-3">
  
      <div [@fadeInUp] class="card">
        <mat-horizontal-stepper #stepper="matHorizontalStepper" [linear]="true">
          <mat-step [stepControl]="merchantDetailsForm">
            <form [formGroup]="merchantDetailsForm">
              <ng-template matStepLabel>General</ng-template>

              <div class="content" fxLayout="column" fxLayoutGap="8px">

                <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    <mat-form-field fxFlex="auto">
                    <mat-label>Company Name</mat-label>
                    <input formControlName="companyName" matInput required>
                    <mat-hint>Merchant's business name.</mat-hint>
                    </mat-form-field>
    
                    <mat-form-field fxFlex="auto">
                    <mat-label>Business Category</mat-label>
                    <input formControlName="businessCategoryId" matInput required>
                    <mat-hint>Business type.</mat-hint>
                    </mat-form-field>
                </div>

                <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">

                    <mat-form-field fxFlex="auto">
                        <mat-label>Bank</mat-label>
                        <input formControlName="bankId" matInput required>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>
                             
                      <mat-form-field fxFlex="1 1 auto">
                        <mat-label>Account No.</mat-label>
                        <mat-select formControlName="accountNumber">
                          <mat-option *ngFor="let option of phonePrefixOptions" [value]="option">{{ option }}</mat-option>
                        </mat-select>
                      </mat-form-field>
    
                </div>

                 <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    
                    <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Agent</mat-label>
                        <input formControlName="agid" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>

                      <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Age of Business</mat-label>
                        <input formControlName="businessYears" matInput>
                        <mat-hint align="end">How old is the business?</mat-hint>
                      </mat-form-field>
                    
                 </div>

                 <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Region</mat-label>
                        <input formControlName="region" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>

                      <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Currency</mat-label>
                        <input formControlName="currency" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>
                 </div>

                 <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Merchant Code</mat-label>
                        <input formControlName="merchantCode" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>

                      <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Call Back Url</mat-label>
                        <input formControlName="callbackUrl" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>
                 </div>
              </div>
  
              <div class="actions" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="8px">
                <button (click)="stepper.reset()" *ngIf="!merchantRegistered" [disabled]="merchantDetailsForm.pristine" color="primary" mat-button
                        type="button">RESET
                </button>
                <button [disabled]="merchantDetailsForm.invalid" color="primary" mat-raised-button matStepperNext>NEXT
                </button>
              </div>
            </form>
          </mat-step>

          

          <mat-step [stepControl]="merchantContactForm">
            <form [formGroup]="merchantContactForm">
              <ng-template matStepLabel>Contact</ng-template>

  
              <div class="content" fxLayout="column" fxLayoutGap="8px">
                <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    <mat-form-field fxFlex="auto">
                    <mat-label>Email</mat-label>
                    <input formControlName="email" matInput required>
                    <mat-hint>Business email.</mat-hint>
                    </mat-form-field>
    
                    <mat-form-field fxFlex="auto">
                    <mat-label>Phone No</mat-label>
                    <input formControlName="phoneNumber" matInput required>
                    <mat-hint>Business phone number.</mat-hint>
                    </mat-form-field>
                </div>

                <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">

                    <mat-form-field fxFlex="auto">
                        <mat-label>Primary Contact Email</mat-label>
                        <input formControlName="primaryContactEmail" matInput required>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>
                             
                      <mat-form-field fxFlex="1 1 auto">
                        <mat-label>Primary Contact Name</mat-label>
                        <mat-select formControlName="primaryContactName">
                          <mat-option *ngFor="let option of phonePrefixOptions" [value]="option">{{ option }}</mat-option>
                        </mat-select>
                      </mat-form-field>
    
                </div>

                 <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    
                    <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Primary Contact Mobile</mat-label>
                        <input formControlName="primaryContactPhoneNumber" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>

                      <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Primary Contact Telephone</mat-label>
                        <input formControlName="primaryContactTelephone" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>
                    
                 </div>

                 <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Secondary Contact Name</mat-label>
                        <input formControlName="secondaryContactName" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>

                      <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Secondary Contact Email</mat-label>
                        <input formControlName="secondaryContactEmail" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>
                 </div>

                 <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Secondary Contact Telephone</mat-label>
                        <input formControlName="secondaryContactTelephone" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>

                      <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Website Url</mat-label>
                        <input formControlName="websiteLink" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>
                 </div>

                 <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fxLayoutGap.gt-xs="24px">
                    <mat-form-field fxFlex="2 1 auto">
                        <mat-label>Address</mat-label>
                        <input formControlName="address" matInput>
                        <mat-hint align="end"></mat-hint>
                      </mat-form-field>
                 </div>
              </div>
             
  
              <div class="actions" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="8px">
                <button (click)="stepper.reset()" *ngIf="!merchantRegistered" [disabled]="merchantContactForm.pristine" color="primary" mat-button
                        type="button">RESET
                </button>
                <button class='d-none' id='register-merchant' matStepperNext></button>
                <button [disabled]="merchantContactForm.invalid || loaders?.registering" color="primary" mat-raised-button (click)="registerMerchant()">NEXT <small class='loader' *ngIf="loaders?.registering"></small>
                </button>
              </div>
            </form>
          </mat-step>
  
          <mat-step [stepControl]="OTPForm">
            <form [formGroup]="OTPForm">
              <ng-template matStepLabel>OTP</ng-template>

              <div class="subheading">Enter the OTP that was just sent to you.</div>
  
              <div class="content" fxLayout="column" fxLayoutGap="8px">
                <mat-form-field fxFlex="auto">
                  <mat-label>OTP</mat-label>
                  <input [type]="passwordInputType" formControlName="otp" matInput required>
                  <button (click)="showPassword()" *ngIf="passwordInputType === 'password'" mat-icon-button matSuffix
                          type="button">
                    <mat-icon>visibility</mat-icon>
                  </button>
                  <button (click)="hidePassword()" *ngIf="passwordInputType === 'text'" mat-icon-button matSuffix
                          type="button">
                    <mat-icon>visibility_off</mat-icon>
                  </button>
                  <mat-hint>Your OTP should be at least 6 characters long.</mat-hint>
                </mat-form-field>
  
                <!-- <mat-form-field fxFlex="auto">
                  <mat-label>Confirm Password</mat-label>
                  <input [type]="passwordInputType" formControlName="passwordConfirm" matInput required>
                  <button (click)="showPassword()" *ngIf="passwordInputType === 'password'" mat-icon-button matSuffix
                          type="button">
                    <mat-icon>visibility</mat-icon>
                  </button>
                  <button (click)="hidePassword()" *ngIf="passwordInputType === 'text'" mat-icon-button matSuffix
                          type="button">
                    <mat-icon>visibility_off</mat-icon>
                  </button>
                  <mat-hint>Please type in your password again.</mat-hint>
                </mat-form-field> -->
              </div>
  
              <div class="actions" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="8px">
                <button class='d-none' matStepperNext id='verify-registration'></button>
                <button color="primary" mat-button matStepperPrevious type="button">PREVIOUS</button>
                <button [disabled]="OTPForm.invalid || loaders?.verifying" color="primary" mat-raised-button (click)="verifyRegistration()">NEXT 
                  <small class='loader' *ngIf="loaders?.verifying"></small>
                </button>
              </div>
            </form>
          </mat-step>
  
          <mat-step [stepControl]="previewForm">
            <form [formGroup]="previewForm">
              <ng-template matStepLabel>Preview | Finish</ng-template>

              <div class="card-body">
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">
                    <div class='row'>
                      <div class='col-md-6'>
                        <b>Company: </b> {{previewData?.companyName}} 
                      </div>
                      <div class='col-md-6'>
                        <b>Business Category: </b> {{previewData?.businessCategoryName}} 
                      </div>
                    </div>
                  </li>

                  <li class="list-group-item">
                    <div class='row'>
                      <div class='col-md-6'>
                        <b>Bank: </b> {{previewData?.bankName}} 
                      </div>
                      <div class='col-md-6'>
                        <b>Account Number: </b> {{previewData?.accountNumber}} 
                      </div>
                    </div>
                  </li>

                  <li class="list-group-item">
                    <div class='row'>
                      <div class='col-md-6'>
                        <b>AG: </b> {{previewData?.agid}} 
                      </div>
                      <div class='col-md-6'>
                        <b>Age of Business: </b> {{previewData?.businessYears}} 
                      </div>
                    </div>
                  </li>

                  
                  <li class="list-group-item">
                    <div class='row'>
                      <div class='col-md-6'>
                        <b>Region: </b> {{previewData?.region}} 
                      </div>
                      <div class='col-md-6'>
                        <b>Currency </b> {{previewData?.currency}} 
                      </div>
                    </div>
                  </li>

                  <li class="list-group-item">
                    <div class='row'>
                      <div class='col-md-6'>
                        <b>Code: </b> {{previewData?.merchantCode}} 
                      </div>
                      <div class='col-md-6'>
                        <b>Call Back Url </b> {{previewData?.callbackUrl}} 
                      </div>
                    </div>
                  </li>

                  </ul>
      
              </div>

              <hr/>
              <div class="subheading mt-3 mb-3">To finish merchant set-up, "Authorize" and click on "Create Merchant".
              </div>
  
              <div class="content" fxLayout="column" fxLayoutGap="8px">
                <mat-checkbox class="checkbox" formControlName="authorize">
                  Authorize.
                </mat-checkbox>
              </div>
  
              <div class="actions" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="8px">
                <button color="primary" mat-button matStepperPrevious type="button">PREVIOUS</button>
                <button (click)="submit()" [disabled]="previewForm.invalid" color="primary" mat-raised-button
                        matStepperNext>
                  Create Merchant
                </button>
              </div>
            </form>
  
          </mat-step>
          
        </mat-horizontal-stepper>
      </div>

    </div>
  
  </fury-page>
  